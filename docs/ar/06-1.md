---
lang-ref: ch.06-1
lang: ar
lecturer: Yann LeCun
title: Applications of Convolutional Network
authors: Shiqing Li, Chenqin Yang, Yakun Wang, Jimin Tan
date: 2 Mar 2020
translation date: 1 Sep 2020
translator: Ali elfilali
---

## [التعرف على الرمز البريدي](https://www.youtube.com/watch?v=ycbMGyCPzvE&t=43s)

في الدرس السابق ، أوضحنا كيف يمكن للشبكات الالتفافية التعرف على الأرقام ، لكننا لم نجب على سؤال كيف يمكن للنموذج معرفة الارتباك الناجم عن الأرقام المجاورة له عند اختيار كل رقم. تتمثل الخطوة التالية في اكتشاف الكائنات المتداخلة / غير المتداخلة واستخدام نهج ((Non-Maximum Supression (NMS)  بالنظر إلى افتراض أن المدخلات عبارة عن أرقام غير متداخلة في هذا المثال ، فإن الاستراتيجية التي يجب اتباعها هي تدريب شبكات الالتفافية متعددة واختيار الرقم الحاصل على أعلى الدرجات الناتجة عن الشبكة أو عن طريق التصويت بالأغلبية.



###  CNN التعرف بواسطة  

نقدم هنا مهمة التعرف على الرموز البريدية غير المتداخلة المكونة من خمسة أرقام. لم يتم إعطاء النظام تعليمات حول كيفية فصل كل رقم ، لكن النظام يعرف أنه يجب عليه تقدير خمسة أرقام. تين. كما هو موضح في (الشكل 1)، يتكون النظام من شبكات الالتفافية في 4 أبعاد مختلفة ، ينتج كل منها مخرجات مختلفة. يظهر الإخراج في شكل مصفوفة. تأتي مصفوفات الإخراج الأربع من نماذج ذات عروض نواة مختلفة في الطبقة الأخيرة. يحتوي كل ناتج على 10 صفوف تمثل 10 فئات من 0 إلى 9. يمثل المربع الأبيض الأكبر درجة أعلى في تلك الفئة. في كتل الإخراج الأربعة هذه ، تكون أبعاد نوى الطبقة الأخيرة على المحور الأفقي هي 5 و 4 و 3 و 2 على التوالي. يحدد حجم النواة عرض النافذة التي ينظر النموذج من خلالها إلى المدخلات. ثم يختار النموذج الفئة التي حصلت على أعلى الدرجات في تلك النافذة. يأخذ النموذج بعد ذلك تصويت الأغلبية لاستخراج معلومات مفيدة ، يجب على المرء أن يضع في اعتباره أنه ليست كل مجموعات الأحرف ممكنة، وبالتالي سيكون من المفيد إجراء تصحيحات للأخطاء باستخدام قيود الإدخال للتأكد من أن المخرجات هي الرموز البريدية الصحيحة.

<center>
<img src="{{site.baseurl}}/images/week06/06-1/O1IN3JD.png" style="zoom: 40%; background-color:#DCDCDC;"/><br>
<b>الشكل 1 :</b> مصنفات متعددة للتعرف على الرمز البريدي
</center>
الحيلة هي استخدام أقصر خوارزمية مسار لتحديد ترتيب الأحرف. نظرًا لأننا نعرف فترات الأحرف المحتملة وعدد الأرقام الإجمالي التي نحتاج إلى التنبؤ بها ، يمكننا التعامل مع هذه المشكلة من خلال حساب الحد الأدنى لتكلفة الأرقام  و الانتقال بينها. يجب أن يكون المسار مستمراً من الخلية اليسرى السفلية إلى الخلية اليمنى العلوية على الرسم البياني ويجب أن يكون مقيدًا ليشمل حركات معينة من اليمين إلى اليسار ، ومن أعلى إلى أسفل. لاحظ أنه في حالة تكرار نفس الأرقام جنبًا إلى جنب ، يجب أن تكون الخوارزمية قادرة على التمييز بين هذه الأرقام كأرقام متكررة بدلاً من تخمينها بأرقام فردية.



## [التعرف على الوجه](https://www.youtube.com/watch?v=ycbMGyCPzvE&t=1241s)

تعمل الشبكات العصبية الالتفافية بشكل جيد في مهام الكشف ولا يعد الكشف عن الوجوه استثناءً. لإجراء التعرف على الوجوه ، نحتاج إلى إنشاء مجموعة بيانات من الصور الوجوه و أخرى بدونها ، حيث سنقوم بتدريب شبكة الالتفافية ، ونسأل عما إذا كان المدخل إلى الشبكة يحتوي على وجه. عندما نطبق النموذج على صورة جديدة بعد التدريب ، إذا كان هناك وجه فسوف تتوهج الشبكة الالتفافية في المواضع المقابلة. ومع ذلك ، هناك مشكلتان:


- **الموجب المزيف**: هناك العديد من الأشكال المختلفة التي ليست وجهًا والتي قد تظهر في رقعة من الصورة. خلال مرحلة التدريب ، قد لا يرى النموذج كل منهم (* أي * مجموعة تمثيلية بالكامل من البقع التي لا تمثل الوجه). لذلك ، قد يعاني النموذج من الكثير من الإيجابيات الخاطئة في وقت الاختبار. على سبيل المثال ، إذا لم يتم تدريب الشبكة على الصور التي تحتوي على الأيدي ، فقد تكتشف الوجوه بناءً على درجات لون البشرة وتصنف بشكل غير صحيح بقع من الصور التي تحتوي على الأيدي كوجوه ، مما يؤدي إلى ظهور إيجابيات زائفة.




- **اختلاف حجم الوجوه:** ليست كل الوجوه بنفس الحجم ، لذلك قد لا يتم اكتشاف الوجوه ذات الأحجام المختلفة. تتمثل إحدى طرق التعامل مع هذه المشكلة في إنشاء إصدارات متعددة المقاييس من نفس الصورة. في حالة تطبيق مقياس على صورة بعامل جدر مربع 2 ، سيكتشف النموذج الوجوه الأصغر في الصورة الأصلية. لاكتشاف الوجوه الأكبر ، يمكننا تصغير حجم الصورة. هذه العملية غير مكلفة لأن نصف النفقات تأتي من معالجة الصورة الأصلية غير المقاسة. مجموع نفقات جميع الشبكات الأخرى مجتمعة هو نفسه تقريبًا مثل معالجة الصورة الأصلية غير المقاسة. حجم الشبكة هو مربع حجم الصورة على جانب واحد ، لذلك إذا قمت بتصغير الصورة بجدر مربع 2، فإن الشبكة التي تحتاج إلى تشغيلها تكون أصغر بمعامل 2. وبالتالي فإن التكلفة الإجمالية هي 1 دولار + 1/2 + 1/4 + 1/8 + 1/16... ، وهو 2. أداء نموذج متعدد المقاييس يضاعف فقط التكلفة الحسابية.`

  


###  نظام كشف الوجوه متعدد المقاييس

<center>
<img src="{{site.baseurl}}/images/week06/06-1/8R3v0Dj.png" style="zoom: 30%; background-color:#DCDCDC;"/><br>
<b>الشكل 2:</b> نظام الكشف عن الوجه
</center>
تشير الخرائط الموضحة في (الشكل 3) إلى عشرات أجهزة كشف الوجه. يتعرف كاشف الوجه هذا على الوجوه التي يبلغ حجمها 20 × 20 بكسل. في المقياس الدقيق (المقياس 3) هناك العديد من الدرجات العالية ولكنها ليست نهائية للغاية. عندما يرتفع عامل التحجيم (المقياس 6) ، نرى المزيد من المناطق البيضاء المتجمعة. تمثل تلك المناطق البيضاء الوجوه المكتشفة. نطبق بعد ذلك إخماد القيم الأدنى للحصول على الموقع النهائي للوجه.

<center>
<img src="{{site.baseurl}}/images/week06/06-1/CQ8T00O.png" style="zoom: 40%; background-color:#DCDCDC;"/><br>
<b>الشكل 3:</b> درجات كشف الوجه لعوامل التحجيم المختلفة
</center>


###  إخماد القيم الأدنى  

لكل منطقة عالية التدرجات ، من المحتمل أن يكون هناك وجه. إذا تم اكتشاف المزيد من الوجوه بالقرب من الأول ، فهذا يعني أنه يجب اعتبار وجه واحد فقط صحيحًا والباقي خاطئ. مع خوارزمية *إخماد القيم الأدنى* نأخذ أعلى درجات المربعات المحيطة المتداخلة ونزيل المربعات الأخرى. ستكون النتيجة إحاطة  مربع واحد في الموقع الأمثل.




###  التعدين السلبي (Negative Mining)

في القسم الأخير ، ناقشنا كيف يمكن أن يواجه النموذج عددًا كبيرًا من الإيجابيات الخاطئة في وقت الاختبار حيث توجد العديد من الطرق لكي تظهر الكائنات غير الوجهية بشكل مشابه للوجه. لن تتضمن أي مجموعة تدريب جميع الكائنات غير الوجوه المحتملة التي تشبه الوجوه. يمكننا تخفيف هذه المشكلة من خلال التعدين السلبي. في التعدين السلبي ، نقوم بإنشاء مجموعة بيانات سلبية من التصحيحات غير الوجهية التي اكتشفها النموذج (خطأ) كوجوه. يتم جمع البيانات عن طريق تشغيل النموذج على المدخلات المعروف أنها لا تحتوي على وجوه. ثم نقوم بإعادة تدريب الكاشف باستخدام مجموعة البيانات السلبية. يمكننا تكرار هذه العملية لزيادة متانة نموذجنا ضد الإيجابيات الزائفة.




## **التجزئة الدلالية** (*Semantic segmentation*)

التجزئة الدلالية هي مهمة تعيين فئة لكل بكسل في صورة الإدخال.




### [الشبكات العصبية الالتفافية لرؤية الروبوتات التكيفية طويلة المدى](https://www.youtube.com/watch?v=ycbMGyCPzvE&t=1669s)

في هذا المشروع ، كان الهدف هو تسمية المناطق من الصور المدخلة حتى يتمكن الروبوت من التمييز بين الطرق والعقبات. في الشكل ، المناطق الخضراء هي مناطق يمكن للروبوت أن يقود عليها والمناطق الحمراء تمثل عوائق مثل العشب الطويل. لتدريب الشبكة على هذه المهمة ، أخذنا تصحيحًا من الصورة وقمنا يدويًا بتسميته بأنه قابل للعبور أم لا (أخضر أو أحمر). ثم نقوم بتدريب الشبكة الالتفافية على الرقع من خلال مطالبتهم بالتنبؤ بلون الرقعة. بمجرد أن يتم تدريب النظام بشكل كافٍ ، يتم تطبيقه على الصورة بأكملها ، مع تسمية جميع مناطق الصورة باللون الأخضر أو الأحمر.



<center>
<img src="{{site.baseurl}}/images/week06/06-1/5mM7dTT.png" style="zoom: 40%; background-color:#DCDCDC;"/><br>
<b>الشكل 4: </b>:</b> الشبكات العصبية الالتفافية لرؤية الروبوتات التكيفية طويلة المدى
</center>
كانت هناك خمس فئات للتنبؤ: 1) الأخضر الفائق ، 2) الأخضر ، 3) الأرجواني: خط قدم العائق ، 4) العائق الأحمر 5) الأحمر الفائق: بالتأكيد عقبة.



### تسميات ستيريو 

يتم التقاط الصور بالكاميرات الأربع الموجودة في الروبوت ، والتي تم تجميعها في زوجي رؤية ستريو. باستخدام المسافات المعروفة بين الكاميرات المزدوجة الاستريو ، يتم بعد ذلك تقدير مواضع كل بكسل في الفضاء ثلاثي الأبعاد عن طريق قياس المسافات النسبية بين وحدات البكسل التي تظهر في كلتا الكاميرتين في زوج استريو. هذه هي نفس العملية التي تستخدمها أدمغتنا لتقدير مسافة الأشياء التي نراها. باستخدام معلومات الموقع المقدرة ، يتلاءم المستوى مع الأرض ، ثم يتم تصنيف وحدات البكسل على أنها خضراء إذا كانت بالقرب من الأرض والأحمر إذا كانت فوقها.



* الشبكات العصبية الالتفافية: القيود والمحفزات:  تعمل الرؤية المجسمة فقط حتى 10 أمتار وتتطلب قيادة الروبوت رؤية بعيدة المدى. ومع ذلك ، فإن الشبكة الالتفافية قادرة على اكتشاف الأشياء على مسافات أكبر بكثير ، إذا تم تدريبها بشكل صحيح.

  

<center>
<img src="{{site.baseurl}}/images/week06/06-1/rcxY4Lb.png" style="zoom: 100%; background-color:#DCDCDC;"/><br>
<b>الشكل 5:</b> هرم الحجوم الثابتة للصور المقاسة عن بعد
</center>



> - ##### توظيف كمدخلات للنموذج:  تتضمن المعالجة المسبقة بناء هرم الحجوم الثابتة للصور المقاسة عن بعد (الشكل 5). إنه مشابه لما فعلناه في وقت سابق من هذه المحاضرة عندما حاولنا اكتشاف الوجوه ذات المقاييس المتعددة.
>



**مخرجات النموذج** (الشكل 4 ، العمود 3)

يقوم النموذج بإخراج تسمية لكل بكسل في الصورة حتى الأفق. هذه هي مخرجات المصنف للشبكة الالتفافية متعددة المقاييس.     

* **كيف يصبح النموذج متكيفًا**: تتمتع الروبوتات بوصول مستمر إلى تسميات الاستريو ، مما يسمح للشبكة بإعادة التدريب والتكيف مع البيئة الجديدة التي توجد بها. يرجى ملاحظة أنه سيتم إعادة تدريب الطبقة الأخيرة فقط من الشبكة. يتم تدريب الطبقات السابقة في المختبر وتثبيتها.



### **أداء النظام**

عند محاولة الوصول إلى إحداثيات GPS على الجانب الآخر من الحاجز ، الروبوت "رأى" الحاجز من بعيد وخطط لطريق كي يتجنبه. هذا بفضل شبكة CNN التي تقوم باكتشاف الأجسام على بعد 50-100 متر.



### قيود

رجوعا إلى 2000s ، كانت قدرات الحوسبة جد ضعيفة. بحيث كان الروبوت قادرًا على معالجة حوالي إطار واحد فقط في الثانية ، مما يعني أنه لن يكون قادرًا على اكتشاف شخص يسير في طريقه لمدة ثانية كاملة قبل أن يكون قادرًا على الرد. الحل لهذا القيد هو **نموذج قياس المسافات المرئي منخفض التكلفة**. إنه لا يعتمد على الشبكات العصبية ، وله رؤية 2.5 متر تقريبًا ولكنه يتفاعل بسرعة.



#### **تحليل المشهد و وضع الأسماء** 

في هذه المهمة ، يُخرج النموذج فئة الكائن (مبنى ، سيارة ، سماء ، إلخ) لكل بكسل. المعمارية أيضًا متعددة المقاييس (الشكل 6).

<center>
<img src="{{site.baseurl}}/images/week06/06-1/VpVbkl5.jpg" style="zoom: 30%; background-color:#DCDCDC;"/><br>
<b>الشكل 6:</b>شبكة عصبية إلتفافية متعددة المقاييس لتحليل المشاهد
</center>



لاحظ أنه إذا قمنا بإعادة عرض مخرج واحد من CNN على المدخلات ، فإنه يتوافق مع مدخل بحجم 46 × 46 على الصورة الأصلية في أسفل هرم لابلاس. هذا يعني أننا نستخدم ''**سياق 46 × 46 بكسل لتحديد فئة البكسل المركزي**.''



ومع ذلك ، أحيانًا لا يكون حجم هذا السياق كافيًا لتحديد فئة كائنات أكبر.



**يتيح النهج متعدد النطاقات رؤية أوسع من خلال توفير صور إضافية تم إعادة قياسها كمدخلات.** والخطوات هي كما يلي:

1.  خذ نفس الصورة ، اختزلها بمعامل 2 ثم معامل 4 ، كل على حدة.

2.  يتم تغذية هاتين الصورتين الإضافيتين المعاد قياسهما إلى نفس الشبكة الالتفافية "ConvNet" (نفس الأوزان ونفس الأنوية) ونحصل على مجموعتين أخريين من خصائص المستوى 2.
3. قم بتجميع هذه الخصائص بحيث يكون لها نفس حجم خصائص المستوى 2 للصورة الأصلية.

4. كدس المجموعات الثلاث من الخصائص المجمعة معًا ثم قم بتغذيتها للمصنف.



الآن أكبر حجم فعال للمحتوى ، والذي يأتي من الصورة التي تم تغيير حجمها ب1/4 ، هو 184 × 184 (46 × 4 = 184).



**الأداء**: مع عدم وجود معالجة لاحقة وتشغيل إطار بإطار ، يعمل النموذج بسرعة كبيرة حتى على الأجهزة العادية. يحتوي على حجم صغير إلى حد ما من بيانات التدريب (2k ~ 3k) ، لكن النتائج لا تزال تحطم الأرقام القياسية!

-----------------------------------------------------------------------------------------------------------------------------------------------------

